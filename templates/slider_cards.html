
<div class="new-products-slider-wrapper">
    <button class="arrow left" id="prev">&#10094;</button>
    <div class="new-products-slider" id="slider">
        {% for product in products %}
        {% set publish_date = product["publish_date"] | default('1970-01-01') %}
        {% set days_since_publish = ( current_time  - publish_date).days %}
        {% if days_since_publish <= 2 %}
            <div class="slider-card">
            <img src="{{ url_for('static', filename='uploads/' ~ product['image_url'].split('/')[-1]) }}" 
                alt="{{ product['name'] }}" class="slider-image">
            <div class="slider-info">
                <h3>{{ product['name'] }}</h3>
                {% if product["features"] %}
                <ul class="features-list">
                    {% for feat in product["features"].split(",") %}
                    <li>{{ feat.strip() }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
                <p class="regular-price">₪ {{ product["regular_price"] }}</p>
                <p class="sale-price">₪ {{ product["discount_price"] }}</p>
            </div>
            </div>
        {% endif %}
        {% endfor %}
    </div>
    <button class="arrow right" id="next">&#10095;</button>
</div>


<script>
document.addEventListener("DOMContentLoaded", function () {
  const slider = document.getElementById("slider");
  const cards = slider.children;
  const totalCards = cards.length;

  let currentIndex = 0;
  const cardWidth = 300;

  function goToSlide(index) {
    currentIndex = (index + totalCards) % totalCards; 
    slider.style.transform = `translateX(-${currentIndex * cardWidth}px)`;
  }

  let autoSlide = setInterval(() => {
    goToSlide(currentIndex + 1);
  }, 3000);

  document.getElementById("next").addEventListener("click", () => {
    goToSlide(currentIndex + 1);
    resetInterval();
  });

  document.getElementById("prev").addEventListener("click", () => {
    goToSlide(currentIndex - 1);
    resetInterval();
  });

  function resetInterval() {
    clearInterval(autoSlide);
    autoSlide = setInterval(() => {
      goToSlide(currentIndex + 1);
    }, 3000);
  }
});
</script>
